<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Pronunciation Practice</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; margin: 20px; background-color: #f4f4f4; color: #333; }
        #word, #sentence { font-size: 24px; margin: 20px; font-weight: bold; }
        #feedback, #sentence-feedback, #tip, #streak { margin-top: 20px; font-weight: bold; }
        #feedback { color: green; }
        #sentence-feedback { color: blue; }
        #tip { color: orange; }
        #streak { color: red; }
        select, button { margin: 10px; padding: 10px; border: none; border-radius: 5px; cursor: pointer; }
        button { background-color: #007bff; color: white; }
        button img { width: 20px; height: 20px; vertical-align: middle; }
    </style>
</head>
<body>
    <h1>English Pronunciation Practice</h1>
    <p id="streak">üî• Streak: <span id="streak-count">0</span> days</p>
    <label for="difficulty">Choose difficulty:</label>
    <select id="difficulty" onchange="changeDifficulty()">
        <option value="easy">Easy</option>
        <option value="medium">Medium</option>
        <option value="hard">Hard</option>
    </select>
    <p id="lesson">Today's Lesson: Pronounce the given word and sentence correctly!</p>
    <p id="word">Loading...</p>
    <p><strong>Sounds like:</strong> <span id="phonetic">Loading...</span></p>
    <p id="sentence">Generating sentence...</p>
    <button onclick="speakWord()"><img src="speaker-icon.png" alt="Speak"> Listen to Word</button>
    <button onclick="speakSentence()"><img src="speaker-icon.png" alt="Speak"> Listen to Sentence</button>
    <button onclick="startRecognition()"><img src="mic-icon.png" alt="Mic"> Speak</button>
    <button onclick="nextWordSentence()">Next</button>
    <p id="feedback"></p>
    <p id="sentence-feedback"></p>
    <p id="tip"></p>
    
    <script>
        let streak = localStorage.getItem("streak") || 0;
        document.getElementById("streak-count").textContent = streak;

        function updateStreak() {
            streak++;
            localStorage.setItem("streak", streak);
            document.getElementById("streak-count").textContent = streak;
        }

        function resetStreak() {
            streak = 0;
            localStorage.setItem("streak", streak);
            document.getElementById("streak-count").textContent = streak;
        }

        function fetchWord() {
            fetch("https://random-word-api.herokuapp.com/word")
                .then(response => response.json())
                .then(data => {
                    let word = data[0];
                    document.getElementById("word").textContent = word;
                    document.getElementById("phonetic").textContent = "Loading pronunciation...";
                    fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${word}`)
                        .then(response => response.json())
                        .then(data => {
                            let phonetic = data[0]?.phonetics[0]?.text || "N/A";
                            document.getElementById("phonetic").textContent = phonetic;
                        })
                        .catch(() => {
                            document.getElementById("phonetic").textContent = "N/A";
                        });
                    document.getElementById("sentence").textContent = `Use '${word}' in a sentence.`;
                })
                .catch(error => {
                    console.error("Error fetching word:", error);
                    document.getElementById("word").textContent = "Error loading word.";
                    document.getElementById("phonetic").textContent = "N/A";
                });
        }

        function nextWordSentence() {
            fetchWord();
            document.getElementById("feedback").textContent = "";
            document.getElementById("sentence-feedback").textContent = "";
            document.getElementById("tip").textContent = "";
        }

        function speakWord() {
            let word = document.getElementById("word").textContent;
            let utterance = new SpeechSynthesisUtterance(word);
            utterance.lang = "en-GB";
            speechSynthesis.speak(utterance);
        }

        function speakSentence() {
            let sentence = document.getElementById("sentence").textContent;
            let utterance = new SpeechSynthesisUtterance(sentence);
            utterance.lang = "en-GB";
            speechSynthesis.speak(utterance);
        }

        function startRecognition() {
            const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
            recognition.lang = "en-GB";
            recognition.start();
            recognition.onresult = (event) => {
                let spokenWord = event.results[0][0].transcript;
                let correctWord = document.getElementById("word").textContent;
                let feedback = document.getElementById("feedback");
                if (spokenWord.toLowerCase() === correctWord.toLowerCase()) {
                    feedback.textContent = "‚úÖ Correct pronunciation!";
                    updateStreak();
                } else {
                    feedback.textContent = "‚ùå Try again: " + correctWord;
                    resetStreak();
                }
            };
        }

        window.onload = fetchWord;
    </script>
</body>
</html>
